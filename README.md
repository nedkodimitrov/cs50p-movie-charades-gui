# CS50P Movie Charades GUI

#### Video Demo:  [https://youtu.be/F_JiqWmpQ1s](https://www.youtube.com/watch?v=F_JiqWmpQ1s)

## Description:

An interactive game where the user is presented with an AI-generated image from the DALL·E 2 API.
The image is based on a randomly selected movie title from the top 1000 rated movies on MoviesMiniDatabase retrieved through RapidAPI.
The user's task is being given 3 attempts to guess the movie title associated with the image.
The game continues until the user runs out of their 3 lives.


## Setup:

`pip3 install -r requirements.txt`

To begin using OpenAI's DALL-E 2 API, follow these steps:
- Sign up for an OpenAI account by visiting <https://platform.openai.com/signup>. Upon registration, you'll receive a $5 credit that can be used to generate up to 277 images according to the current pricing of $0.018 per 512x512 image.
- Generate an API key by visiting <https://platform.openai.com/account/api-keys>.
- To set it up, execute the following command in your terminal:
`export OPENAI_API_KEY=<YOUR_API_KEY>`

To access MoviesMiniDatabase via Rapid API, follow these steps:
- Visit https://rapidapi.com/auth/sign-up to sign up for a RapidAPI account.
- Once you have successfully signed up, navigate to the API's documentation page at https://rapidapi.com/SAdrian/api/moviesminidatabase/. Here, you'll find detailed information on how to utilize the API effectively.
- Generate your API key by visiting https://rapidapi.com/developer/authorization/<YOUR_APPLICATION>.
- To set it up, execute the following command in your terminal:
`export X_RAPIDAPI_API_KEY=<YOUR_API_KEY>`


## Libraries:
- *_argparse_* - for choosing between the default gui mode or cli mode (using the --cli arg)
- *_openai_* - for accessing OpenAI's DALL-E 2 API
- *_Pillow_* - for opening an image
- *_pyfiglet_* - for printing project title and used APIs
- *_requests_* - for accessing MoviesMiniDatabase via Rapid API
- *_tk_* - for the GUI

## Usage:

`python3 project.py` [--cli]

## Test:

`pip3 install pytest`  
`pytest test_helpers.py`
  
## [Documentation generated via Sphinx](docs/_build/html/index.html)


## project.py contents:

```python
main()
```
The main function parses command-line arguments to decide which mode to run the game in. If the “cli” argument is passed, the game runs in CLI mode, otherwise, it runs in GUI mode.

```python
play_game_cli()
```
Play the Movie Charades game in the Command Line Interface (CLI) mode.

The user is presented with an image generated by the DALL·E 2 API based on a randomly selected movie title. The user is prompted to guess the movie title associated with the image. The game continues until the user runs out of lives.



## helpers.py contains:

```python
download_ai_img(img_prompt: str, image_file_name: str = 'image.png') → bool
```
Download an AI-generated image from the DALL·E 2 API, utilizing a provided prompt using openai.Image.create().

```python
get_random_movie_title()→ str
```
Get a random movie title from the top 1000 rated movies on MoviesMiniDatabase using RapidAPI using request.get().

```python
guess_string(answer: str, attempts: int = 3)→ bool
```
Prompt the user to guess a string in a case-insensitive manner.

```python
mask_string(string: str)→ str
```
Mask a string by replacing every alphanumeric character except the first one with an underscore.

```python
open_img(image_file_name: str = 'image.png')
```
Open and show an image using Pillow.

```python
print_welcome()
```
Using pyfiglet prints a welcome message with ASCII art title and information about the AI and database used.



## MovieCharadesGUI.py contains:

```python
class MovieCharadesGUI(lives=3, attempts=3)
```
CS50P Movie Charades GUI

```python
MovieCharadesGUI.create_footer_label()
```
Create and display the footer label with attribution to the APIs used.

```python
MovieCharadesGUI.create_image_label()
```
Create and display the label for the AI-generated image.

```python
MovieCharadesGUI.create_input_frame()
```
Create and display the input entry and guess button in a frame.

```python
MovieCharadesGUI.create_labels()
```
Create and display the score, lives, header, and masked movie title labels.

```python
MovieCharadesGUI.load_level()
```
Load a new level with a new movie title and AI-generated image.

```python
MovieCharadesGUI.on_guess_button_click()
```
Handler for the Guess button click event.

```python
MovieCharadesGUI.play_game()
```
Start the game by loading the first level.

```python
MovieCharadesGUI.update_lives_label()
```
Update the lives label when the player loses a life.

```python
MovieCharadesGUI.update_remaining_attempts_label(remaining_attempts)
```
Update the label displaying the remaining attempts.

```python
MovieCharadesGUI.update_score_label()
```
Update the score label when the player guesses correctly.

## test_helpers.py contains:


```python
test_download_ai_img(mock_openai_image_create)
```
Mock helpers.openai.Image.create() to return base64 data and assert that download_ai_img() returns True.

```python
test_fail_download_ai_img(mock_openai_image_create)
```
Mock helpers.openai.Image.create() to raise an AuthenticationError.  
Assert that the program exits via sys.exit() and displays that the api key is not set

```python
test_fail_get_random_movie_title(mock_requests_get)
```
Mock response.raise_for_status() to raise a RequestException and set response.status code to 401 and then 403.  
Assert that the program exits via sys.exit() and displays that the api key is not set.

```python
test_fail_guess_string(mock_input)
```
Mock input() to simulate a wrong movie title guess and assert False return value from guess_string().

```python
test_fail_mask_string()
```

```python
test_get_random_movie_title(mock_requests_get)
```
Mock requests.get() to return “Back to the Future” and assert the same title is returned by get_random_movie_title().

```python
test_guess_string(mock_input)
```
Mock input() to simulate a correct movie title guess and assert True return value from guess_string().

```python
test_mask_string()
```
